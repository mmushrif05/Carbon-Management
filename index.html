<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>CarbonTrack Pro | Construction Sustainability Platform</title>
<link rel="stylesheet" href="css/styles.css">
</head>
<body>

<!-- DB STATUS INDICATOR -->
<div class="db-status offline" id="dbStatus">
  <span class="db-dot"></span>
  <span id="dbStatusText">Connecting...</span>
</div>

<!-- LOADING -->
<div class="loading-overlay" id="loadingOverlay">
  <div class="loading-spinner"></div>
  <div class="loading-text">Connecting to database...</div>
</div>

<!-- LOGIN -->
<div id="loginScreen" style="display:none">
  <div class="login-card">
    <div class="login-logo">ğŸŒ</div>
    <div class="login-title">Carbon<span>Track</span> Pro</div>
    <div class="login-sub">Construction Embodied Carbon & Sustainability Platform</div>

    <!-- SIGN IN FORM -->
    <div id="loginForm">
      <div class="login-input">
        <div class="login-label">Email</div>
        <input id="loginEmail" type="email" placeholder="Enter your email" autocomplete="email" />
      </div>

      <div class="login-input">
        <div class="login-label">Password</div>
        <input id="loginPassword" type="password" placeholder="Enter your password" autocomplete="current-password" />
      </div>

      <div class="login-error" id="loginError"></div>

      <button class="login-btn" id="loginBtn" onclick="handleLogin()">Sign In</button>

      <div class="login-toggle">Don't have an account? <a onclick="showRegister()">Create one</a></div>
    </div>

    <!-- REGISTER FORM -->
    <div id="registerForm" style="display:none">
      <div class="login-input">
        <div class="login-label">Full Name</div>
        <input id="regName" placeholder="Enter your full name" autocomplete="name" />
      </div>

      <div class="login-input">
        <div class="login-label">Email</div>
        <input id="regEmail" type="email" placeholder="Enter your email" autocomplete="email" />
      </div>

      <div class="login-input">
        <div class="login-label">Password</div>
        <input id="regPassword" type="password" placeholder="Minimum 6 characters" autocomplete="new-password" />
      </div>

      <div class="login-project">
        <div class="login-label">Project</div>
        <select id="regProject">
          <option value="ksia">King Salman International Airport (KSIA)</option>
        </select>
      </div>

      <div class="login-label">Select Your Role</div>
      <div class="role-grid" id="regRoleGrid">
        <div class="role-btn" onclick="selectRole('contractor',this)"><div class="r-icon">ğŸ—ï¸</div><div class="r-name">Contractor</div><div class="r-desc">Enter actual material data & EPDs</div></div>
        <div class="role-btn" onclick="selectRole('consultant',this)"><div class="r-icon">ğŸ“‹</div><div class="r-name">Consultant</div><div class="r-desc">Review, approve & set baselines</div></div>
        <div class="role-btn" onclick="selectRole('client',this)"><div class="r-icon">ğŸ‘”</div><div class="r-name">Client</div><div class="r-desc">Dashboard, approvals & reports</div></div>
      </div>

      <div class="login-error" id="regError"></div>

      <button class="login-btn" id="regBtn" onclick="handleRegister()">Create Account</button>

      <div class="login-toggle">Already have an account? <a onclick="showLogin()">Sign in</a></div>
    </div>

    <div class="login-footer">v2.0 â€¢ Cloud Database Enabled â€¢ KSIA Sustainability Program</div>
  </div>
</div>

<!-- APP -->
<div id="appShell" style="display:none">
  <button class="menu-toggle" onclick="document.getElementById('sidebar').classList.toggle('open')">â˜°</button>
  <div class="app-layout">
    <nav class="sidebar" id="sidebar">
      <div class="sb-header"><div class="sb-logo"><span class="sb-logo-icon">ğŸŒ</span><span class="sb-logo-text">Carbon<span>Track</span></span></div><div class="sb-version">Pro v2.0 â€¢ Cloud DB</div></div>
      <div class="sb-nav" id="sidebarNav"></div>
      <div class="sb-footer"><div class="sb-user"><div class="sb-avatar" id="userAvatar">C</div><div><div class="sb-uname" id="userName">User</div><div class="sb-urole" id="userRole">Role</div></div></div><div class="sb-logout" onclick="logout()">â† Sign Out</div></div>
    </nav>
    <div class="main-content">
      <div class="page-header"><div class="page-title" id="pageTitle">Dashboard</div><div class="page-desc" id="pageDesc"></div></div>
      <div class="page-body" id="pageBody"></div>
    </div>
  </div>
</div>

<!-- ===== APPLICATION SCRIPTS ===== -->
<!-- No Firebase SDK on client â€” all credentials are on the server -->
<script src="js/data.js"></script>
<script src="js/config.js"></script>
<script src="js/db.js"></script>
<script src="js/state.js"></script>
<script src="js/auth.js"></script>
<script src="js/pages.js"></script>
<script src="js/app.js"></script>
</body>
</html>
